{% extends 'correspondencia/base_correspondencia.html' %}

{% block view_documentos_correspondencia %}
  <style>
    .views {
      display: flex;
    }
    .content_correspondecia {
      display: none;
    }
  </style>

  <section class="container position-relative">
    {% comment %}Estilos para la animación de formulario:{% endcomment %}
    <style>
      #content-form {
        margin-top: 30px;
        border-radius: 12px;
        box-shadow: 0px 0px 10px 2px #505050;
        border: 2px solid #7d7d7d;
        background: #fff;
        left: -700px;
        z-index: 100;
        transition: all 0.5s;
        position: absolute;
        overflow: hidden;
      }
      
      #content-form h4 {
        padding: 12px 12px;
        color: #fff;
        background: var(--colores_institucionalesfondoDegradado3);
      }
    </style>
    {% comment %}Estilos para la animación de formulario:{% endcomment %}
    <div id="content-form">
      <h4 class="text-center">Agrega una acta, documento o formato</h4>
      <form class="p-2 form_agregardoc" action="{% url 'correspondencia:formatos_documentos' %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="p-2">
          <label for="nombre_documento"><strong>Nombre del Documento</strong></label>
          <p>Introduce el nombre del documento que estás subiendo.</p>
          {{ form_cargar_docs.nombre_documento }}
        </div>
        <div class="p-2">
          <label for="descripcion"><strong>Describe el documento:</strong></label>
          <p>Proporciona una breve descripción del contenido del documento.</p>
          {{ form_cargar_docs.descripcion }}
        </div>
        <div class="p-2">
          <label for="version"><strong>Versión</strong></label>
          <p>Especifica la versión del documento, si aplica.</p>
          {{ form_cargar_docs.version }}
        </div>
        <div class="p-2">
          <label for="documento_convert"><strong>Documento Convertido</strong></label>
          <p>Sube el documento convertido en el formato requerido.</p>
          {{ form_cargar_docs.documento_convert }}
        </div>

        <div class="d-flex justify-content-center">
          <button type="submit" class="btn m-2 btn-primary">Enviar</button>
          <button id="btn_cerrar_formdocs" type="button" class="btn m-2 btn-danger">Cerrar</button>
        </div>
      </form>
    </div>
    <h3 class="mt-3">Formatos de documentos</h3>
    <article class="d-flex flex-column justify-content-center align-items-center">
      <p class="text-center" style="z-index: 0;">
        <strong>Estos son los formatos cargados.</strong><br /> Para agregar un nuevo formato, haz clic en el botón a continuación:
      </p>
      <a href="#content-form" id="btn_agregar" class="mb-2    btn btn-primary">Agrega un formato</a>
      <div class="mt-1 p-3 w-100" style="display: grid;justify-items: center; grid-template-columns: repeat(auto-fill, minmax(18rem, 1fr)); gap: 1rem; border-top:1px solid #cacaca;">
        {% if formatos %}
          {% for key, value in formatos.items %}
            <div class="card d-flex flex-column justify-content-between" style="width: 18rem;">
              <embed class="card-img-top" src="data:application/pdf;base64,{{ value.documento }}" type="application/pdf" />
              <div class="card-body">
                <h5 class="card-title">{{ value.nombre_documento }}</h5>
                <p class="card-text">{{ value.descripcion }}</p>
                <p class="card-text">{{ value.version }}</p>
                <p class="card-text">{{ value.fecha_cargue }}</p>
                <div class="botones d-flex justify-content-between">
                  <a href="{% url 'correspondencia:editar_formato' value.id %}" class="btn btn-warning">Editar</a>
                  <a href="{% url 'correspondencia:eliminar_formato' value.id %}" class="btn btn-danger" onclick="return confirm('¿Estás seguro de que deseas eliminar esto?')">Eliminar</a>
                </div>
              </div>
            </div>
          {% endfor %}
        {% else %}
          <p>No se ha cargado ningun formato ni acuerdo.</p>
        {% endif %}
      </div>
    </article>
  </section>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const content_form = document.getElementById('content-form')
      const btn_cerrar_formdocs = document.getElementById('btn_cerrar_formdocs')
      const btn_agregar = document.getElementById('btn_agregar')
    
      console.log(content_form)
      console.log(btn_cerrar_formdocs)
      console.log(btn_agregar)
    
      let estado = false
      btn_agregar.onclick = () => {
        console.log('funcionando')
        estado = !estado
        console.log(estado)
        if (estado) {
          content_form.style.left = '50%'
          content_form.style.top = '40%'
          content_form.style.transform = 'translate(-50%, -50%)'
        }
      }
      btn_cerrar_formdocs.onclick = () => {
        estado = false
        content_form.style.left = '-700px'
        content_form.style.top = '40%'
        content_form.style.transform = 'translate(-50%, -50%)'
      }
    })
  </script>
{% endblock %}
